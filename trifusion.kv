#:kivy 1.8.0

<ShowcaseScreen>:
    ScrollView:
        do_scroll_x: False
        do_scroll_y: False if root.fullscreen else (content.height > root.height - dp(16))
        AnchorLayout:
            size_hint_y: None
            height: root.height if root.fullscreen else max(root.height, content.height)
            GridLayout:
                id: content
                cols: 1

<MainHeader@ActionToggleButton>:
    size_hint_x: 1
    font_size: 20
    bold: True
    group: "main_header"

<MainAction@ActionBar>:
    pos_hint: {'top':1}

    ActionView:
        ActionPrevious:
            size_hint_x: 0.2
            with_previous: False
            on_release:
                app.side_panel_toggle()
            canvas.before:
                Color:
                    rgba: (0.180, 0.180, 0.180, .8)
                Rectangle:
                    pos: self.pos
                    size: self.size

        MainHeader:
            text: "Orthology"
            background_down: "data/backgrounds/orthology_down.png"
            canvas.before:
                Color:
                    rgba: [255, .200, .200, .8]
                Rectangle:
                    pos: self.pos
                    size: self.size
            on_release:
                idx = app.screen_names.index("Orthology")
                app.go_screen(idx)

        MainHeader:
            text: "Process"
            background_down: "data/backgrounds/process_down.png"
            canvas.before:
                Color:
                    rgba: (0.200, 0.200, 255, .8)
                Rectangle:
                    pos: self.pos
                    size: self.size
            on_release:
                idx = app.screen_names.index("Process")
                app.go_screen(idx)

        MainHeader:
            text: "Statistics"
            background_down: "data/backgrounds/statistics_down.png"
            canvas.before:
                Color:
                    rgba: (0.200, 255, 0.200, .8)
                Rectangle:
                    pos: self.pos
                    size: self.size
            on_release:
                idx = app.screen_names.index("Statistics")
                app.go_screen(idx)

        ActionButton:
            size_hint_x: 0.2

<SelectionBox@BoxLayout>:
    orientation: "horizontal"
    size_hint_y: .11
    spacing: 20
    Button:
        text: "Select All"
        disabled: True
    Button:
        text: "Deselect All"
        disabled: True

<SideButton@ToggleButton>:
    group: "side_buttons"
    size_hint_y: .1



BoxLayout:
    orientation: "vertical"

    MainAction:
        id: ap

    BoxLayout:
        id: bx1
        orientation: "horizontal"

        # This BoxLayout will two ScrollView layouts.
        # The first will be the side column with several buttons that will
        # switch the content in the second scrollview layout
        # The second will be the main panel containing the important content
        BoxLayout:
            orientation: "horizontal"
            id: main_box
            size_hint_x: None
            width: 0

            # Both these ScrollView layouts are here because it is the only way
            # that the children layouts' width will be truly 0. If a
            # BoxLayout, Floatlayout, etc would be used, the contents would
            # still appear.
            ScrollView:
                id: sp_bts
                size_hint_x: None
                width: 0
                BoxLayout:
                    orientation: "vertical"
                    SideButton:
                        state: "down"
                        on_release: carousel.load_slide(carousel.slides[0])
                    SideButton:
                        on_release: carousel.load_slide(carousel.slides[1])
                    Widget:
                        size_hint_y: .8
                        canvas.before:
                            Color:
                                rgba: (0.180, 0.180, 0.180, .8)
                            Rectangle:
                                pos: self.pos
                                size: self.size

            ScrollView:
                id: sp
                size_hint_x: .8
                width: 0

                Carousel:
                    id: carousel
                    direction: "bottom"
                    BoxLayout:
                        orientation: "vertical"
                        padding: 10
                        spacing: 10
                        id: main_slide

                        canvas.before:
                            Color:
                                rgba: (0.180, 0.180, 0.180, .8)
                            Rectangle:
                                pos: self.pos
                                size: self.size

                        Button:
                            id: sv_but
                            text: "Open file(s)"
                            size_hint_y: None
                            height: 50
                            on_release:
                                idx = app.screen_names.index("fc")
                                app.go_screen(idx)

                        TabbedPanel:
                            id: main_tp
                            do_default_tab: False
                            background_color: (0,0,0,0)
                            tab_pos: "top_mid"

                            TabbedPanelItem:
                                id: file_tp
                                text: "Files"

                                BoxLayout:
                                    orientation: "vertical"
                                    spacing: 20
                                    ScrollView:
                                        size_hint_y: .9
                                        height: root.height*.65
                                        id: sv_file
                                        GridLayout:
                                            cols: 3
                                            size_hint_y: None
                                            id: file_sl
                                            padding: 10
                                            spacing: [5, 10]
                                            height: root.height*.2
                                            minimum_height: root.height*.1

                                            Button:
                                                id: file_temp
                                                height: root.height*.08
                                                disabled: True
                                                size_hint_y: None
                                                #size_hint_x: None
                                                text: "No files loaded"
                                    SelectionBox:
                                        id: sb_file

                            TabbedPanelItem:
                                id: taxa_tp
                                text: "Taxa"
                                BoxLayout:
                                    orientation: "vertical"
                                    spacing: 20
                                    ScrollView:
                                        size_hint_y: .9
                                        height: root.height*.65
                                        id: sv_sp
                                        GridLayout:
                                            cols: 3
                                            size_hint_y: None
                                            id: taxa_sl
                                            padding: 10
                                            spacing: [5, 10]
                                            Button:
                                                id: species_temp
                                                height: root.height*.08
                                                disabled: True
                                                size_hint_y: None
                                                text: "No species loaded"
                                    SelectionBox:
                                        id: sb_taxa
                    BoxLayout:
                        Button

        ScreenManager:
            id: sm

